<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suppression AdBlue & Reprogrammation Moteur | Expert Auto</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <nav class="navbar">
        <div class="container nav-container">
            <div class="logo">
                <i class="fa-solid fa-gauge-high"></i>
                SUPPRESSION<span class="highlight">ADBLUE.FR</span>
            </div>
            <ul class="nav-links">
                <li><a href="#services">Nos Services</a></li>
                <li><a href="#pourquoi">Expertise</a></li>
                <li><a href="tel:0187665243" class="btn-call"><i class="fa-solid fa-phone"></i> 01 87 66 52 43</a></li>
                <li><a href="#" class="btn-primary pulse" onclick="openChat()">DEVIS GRATUIT <i class="fa-solid fa-bolt"></i></a></li>
            </ul>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-overlay"></div>
        <div class="container hero-content">
            <h1>LIB√âREZ LE POTENTIEL <br>DE VOTRE V√âHICULE</h1>
            <p class="hero-subtitle">Sp√©cialiste de la suppression AdBlue, FAP, EGR et de la reprogrammation moteur. √âconomisez du carburant et √©vitez les pannes co√ªteuses.</p>
            
            <div class="trust-badges">
                <div class="badge"><i class="fa-solid fa-check-circle"></i> Intervention Rapide</div>
                <div class="badge"><i class="fa-solid fa-shield-alt"></i> Garantie √† vie</div>
                <div class="badge"><i class="fa-solid fa-euro-sign"></i> Meilleur Tarif</div>
            </div>

            <div class="hero-buttons">
                <button class="btn-primary big" onclick="openChat()">OBTENIR UN TARIF MAINTENANT <i class="fa-solid fa-arrow-right"></i></button>
                <p class="cta-subtext"><i class="fa-solid fa-clock"></i> R√©ponse en moins de 30 secondes via notre assistant.</p>
            </div>
        </div>
    </header>

    <section id="services" class="services section-dark">
        <div class="container">
            <h2 class="section-title">NOS SOLUTIONS TECHNIQUES <span class="highlight">SUR MESURE</span></h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="card-icon"><i class="fa-solid fa-droplet-slash"></i></div>
                    <h3>Suppression AdBlue (SCR)</h3>
                    <p>Solution d√©finitive aux pannes du syst√®me AdBlue. Fini les voyants moteur, les messages "D√©marrage impossible dans XXX km" et les r√©parations hors de prix.</p>
                    <button class="btn-text" onclick="openChat()">En savoir plus <i class="fa-solid fa-chevron-right"></i></button>
                </div>
                <div class="service-card">
                    <div class="card-icon"><i class="fa-solid fa-filter-circle-xmark"></i></div>
                    <h3>Suppression FAP (DPF)</h3>
                    <p>R√©solvez les probl√®mes de filtre √† particules bouch√©. Retrouvez la puissance d'origine, r√©duisez la consommation et √©vitez la casse moteur.</p>
                    <button class="btn-text" onclick="openChat()">En savoir plus <i class="fa-solid fa-chevron-right"></i></button>
                </div>
                <div class="service-card">
                    <div class="card-icon"><i class="fa-solid fa-microchip"></i></div>
                    <h3>Reprogrammation Moteur</h3>
                    <p>Optimisation cartographie (Stage 1). Augmentez le couple et la puissance tout en r√©duisant votre consommation de carburant. Sur mesure.</p>
                    <button class="btn-text" onclick="openChat()">En savoir plus <i class="fa-solid fa-chevron-right"></i></button>
                </div>
                <div class="service-card">
                    <div class="card-icon"><i class="fa-solid fa-ban"></i></div>
                    <h3>Suppression Vanne EGR</h3>
                    <p>√âvitez l'encrassement de votre admission d'air. Votre moteur respire mieux, s'encrasse moins et gagne en fiabilit√© sur le long terme.</p>
                    <button class="btn-text" onclick="openChat()">En savoir plus <i class="fa-solid fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </section>

    <section id="pourquoi" class="why-us section-light">
        <div class="container">
             <h2 class="section-title-dark">POURQUOI CHOISIR <span class="highlight-dark">NOTRE EXPERTISE ?</span></h2>
             <div class="features-grid">
                 <div class="feature">
                     <i class="fa-solid fa-laptop-code feature-icon"></i>
                     <h4>Mat√©riel de Pointe</h4>
                     <p>Nous utilisons des outils de diagnostic officiels et des logiciels de derni√®re g√©n√©ration pour une intervention s√ªre.</p>
                 </div>
                 <div class="feature">
                    <i class="fa-solid fa-certificate feature-icon"></i>
                    <h4>Garantie Logicielle √† Vie</h4>
                    <p>Nos interventions √©lectroniques sont garanties √† vie contre tout dysfonctionnement logiciel. Vous √™tes tranquille.</p>
                </div>
                <div class="feature">
                    <i class="fa-solid fa-truck-fast feature-icon"></i>
                    <h4>Intervention sur Site Possible</h4>
                    <p>Sur demande, nous pouvons nous d√©placer (selon secteur) pour effectuer l'op√©ration directement chez vous.</p>
                </div>
             </div>
        </div>
    </section>

    <footer>
        <div class="container footer-content">
            <div class="footer-logo">
                <i class="fa-solid fa-gauge-high"></i> SUPPRESSION AD BLUE.FR
            </div>
            <div class="footer-contact">
                <p><i class="fa-solid fa-phone"></i> 01 87 66 52 43 (Appel non surtax√©)</p>
                <p><i class="fa-solid fa-envelope"></i> contact@suppressionadblue.fr</p>
            </div>
            <p class="copyright">&copy; 2026 - Tous droits r√©serv√©s. L'utilisation de v√©hicules modifi√©s sur route ouverte peut √™tre r√©glement√©e.</p>
        </div>
    </footer>

    <div id="chatbot-container">
        <button id="chatbot-toggle">
            <i class="fa-solid fa-comments"></i>
            <span class="notification-badge">1</span>
        </button>

        <div id="chatbot-window">
            <div class="chat-header">
                <div class="header-info">
                    <i class="fa-solid fa-robot"></i>
                    <span>Assistant Technique AdBlue</span>
                </div>
                <span id="chatbot-close">‚úï</span>
            </div>
            
            <div id="chatbot-messages">
                <div class="message bot-message">
                    Bonjour ! Je suis l'assistant technique. Pour obtenir un tarif exact pour une suppression AdBlue, FAP ou une reprogrammation, quel est <b>la marque, le mod√®le et l'ann√©e</b> de votre v√©hicule ?
                </div>
            </div>

            <div class="chat-input-area">
                <input type="text" id="chatbot-input" placeholder="Ex: Peugeot 3008, 2018...">
                <button id="chatbot-send"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <script>
        // ‚¨áÔ∏è‚¨áÔ∏è C'EST ICI QU'IL FAUT COLLER TON LIEN N8N ‚¨áÔ∏è‚¨áÔ∏è
        const WEBHOOK_URL = "https://n8n-ube2.onrender.com/webhook-test/garage-chat"; 

        // -- Logique inchang√©e --
        let sessionId = localStorage.getItem('chat_session_id');
        if (!sessionId) {
            sessionId = "user-" + Math.random().toString(36).substring(2, 9);
            localStorage.setItem('chat_session_id', sessionId);
        }

        const toggleBtn = document.getElementById('chatbot-toggle');
        const closeBtn = document.getElementById('chatbot-close');
        const chatWindow = document.getElementById('chatbot-window');
        const messagesDiv = document.getElementById('chatbot-messages');
        const inputField = document.getElementById('chatbot-input');
        const sendBtn = document.getElementById('chatbot-send');

        window.openChat = function() {
            chatWindow.style.display = 'flex';
            setTimeout(() => inputField.focus(), 100);
            toggleBtn.querySelector('.notification-badge').style.display = 'none'; // Cache la notif
        }

        toggleBtn.addEventListener('click', () => {
            const isHidden = chatWindow.style.display === 'none' || chatWindow.style.display === '';
            chatWindow.style.display = isHidden ? 'flex' : 'none';
            if(isHidden) inputField.focus();
            toggleBtn.querySelector('.notification-badge').style.display = 'none';
        });

        closeBtn.addEventListener('click', () => chatWindow.style.display = 'none');

        function addMessage(text, isUser) {
            const msgDiv = document.createElement('div');
            msgDiv.className = isUser ? 'message user-message' : 'message bot-message';
            msgDiv.innerHTML = text; // Utilise innerHTML pour le gras
            messagesDiv.appendChild(msgDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        async function sendMessage() {
            const text = inputField.value.trim();
            if (!text) return;

            addMessage(text, true);
            inputField.value = "";

            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message bot-loading';
            loadingDiv.innerHTML = '<i class="fa-solid fa-ellipsis fa-fade"></i>';
            loadingDiv.id = "bot-loading";
            messagesDiv.appendChild(loadingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ chatInput: text, sessionId: sessionId })
                });
                
                const data = await response.json();
                if(document.getElementById("bot-loading")) document.getElementById("bot-loading").remove();
                
                const botResponse = data.output || data.text || JSON.stringify(data);
                addMessage(botResponse, false);

            } catch (error) {
                if(document.getElementById("bot-loading")) document.getElementById("bot-loading").remove();
                addMessage("Erreur de connexion au serveur üòì", false);
            }
        }

        sendBtn.addEventListener('click', sendMessage);
        inputField.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>